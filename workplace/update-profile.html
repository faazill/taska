<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taska Elite - Update Profile</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
        body { 
            background: #FFFFFF; 
            min-height: 100vh; 
            color: #666666; 
            padding-top: 80px; 
        }
        .navbar { 
            background: #FFFFFF; 
            padding: 1.5rem 2rem; 
            position: fixed; 
            top: 0; 
            left: 0; 
            right: 0; 
            z-index: 1000; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            border-bottom: 1px solid #E5E5E5; 
        }
        .navbar .logo { 
            font-size: 1.8rem; 
            font-weight: 600; 
            color: #333333; 
        }
        .nav-menu { 
            display: flex; 
            gap: 1.5rem; 
            list-style: none; 
        }
        .nav-menu a { 
            text-decoration: none; 
            color: #666666; 
            font-weight: 400; 
            font-size: 1rem; 
            position: relative; 
            transition: color 0.3s ease; 
        }
        .nav-menu a::after { 
            content: ''; 
            position: absolute; 
            width: 0; 
            height: 2px; 
            bottom: -4px; 
            left: 0; 
            background: #007AFF; 
            transition: width 0.3s ease; 
        }
        .nav-menu a:hover::after, .nav-menu a.active::after { width: 100%; }
        .nav-menu a:hover, .nav-menu a.active { color: #007AFF; font-weight: 500; }
        .hamburger { display: none; font-size: 1.5rem; cursor: pointer; color: #333333; }
        .dashboard-content { 
            padding: 3rem 2rem; 
        }
        .update-section { width: 100%; max-width: 100%; padding: 0 1rem; }
        .update-container { 
            background: #FFFFFF; 
            border-radius: 12px; 
            padding: 2.5rem; 
            width: 100%; 
            border: 1px solid #E5E5E5; 
        }
        .update-header h1 { 
            font-size: 2.2rem; 
            font-weight: 600; 
            text-align: center; 
            margin-bottom: 0.5rem; 
            color: #333333; 
        }
        .update-header p { 
            font-size: 1.1rem; 
            color: #666666; 
            text-align: center; 
            margin-bottom: 2rem; 
        }
        .update-form { display: flex; flex-direction: column; gap: 1.8rem; }
        .form-row { display: flex; gap: 1.5rem; flex-wrap: wrap; }
        .form-group { flex: 1; min-width: 300px; }
        .form-group label { 
            font-weight: 500; 
            color: #333333; 
            margin-bottom: 0.4rem; 
            display: block; 
            font-size: 0.95rem; 
        }
        .custom-input, select.custom-input { 
            width: 100%; 
            padding: 0.9rem; 
            border: 1px solid #E5E5E5; 
            border-radius: 8px; 
            background: #FFFFFF; 
            color: #333333; 
            font-size: 1rem; 
            transition: border-color 0.3s ease; 
        }
        .custom-input:focus, select.custom-input:focus { 
            border-color: #007AFF; 
            outline: none; 
        }
        .custom-input[readonly] { background: #F9F9F9; color: #666666; }
        textarea.custom-input { min-height: 120px; resize: vertical; }
        .form-group.full-width { flex: 100%; }
        .input-with-btn { display: flex; align-items: center; gap: 0.5rem; }
        .fetch-btn { 
            padding: 0.5rem 1rem; 
            background: #007AFF; 
            color: #FFFFFF; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            font-size: 0.8rem; 
            transition: background 0.3s ease; 
        }
        .fetch-btn:hover { background: #005BB5; }
        .summary-box { 
            margin-top: 0.5rem; 
            padding: 1rem; 
            background: #FAFAFA; 
            border-radius: 8px; 
            font-size: 0.9rem; 
            color: #333333; 
            display: none; 
            max-height: 200px; 
            overflow-y: auto; 
            border: 1px solid #E5E5E5; 
        }
        .summary-box ul { list-style: none; padding-left: 0; }
        .summary-box li { margin-bottom: 0.6rem; font-size: 0.85rem; }
        .portfolio-list { list-style: none; padding: 0; }
        .portfolio-list li { display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem; }
        .add-btn { 
            padding: 0.5rem 1rem; 
            background: #007AFF; 
            color: #FFFFFF; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            font-size: 0.9rem; 
            transition: background 0.3s ease; 
        }
        .add-btn:hover { background: #005BB5; }
        .form-actions { display: flex; justify-content: center; gap: 1.5rem; }
        .cta-button { 
            padding: 0.9rem 2.5rem; 
            background: #007AFF; 
            color: #FFFFFF; 
            border: none; 
            border-radius: 8px; 
            font-size: 1rem; 
            font-weight: 500; 
            cursor: pointer; 
            transition: background 0.3s ease; 
        }
        .cta-button:hover { 
            background: #005BB5; 
        }
        .cancel-btn { background: #E5E5E5; color: #333333; }
        .cancel-btn:hover { background: #D1D5DB; }
        footer { 
            background: #FFFFFF; 
            padding: 1rem; 
            text-align: center; 
            border-top: 1px solid #E5E5E5; 
            width: 100%; 
            color: #666666; 
            position: fixed; 
            bottom: 0; 
            left: 0; 
            right: 0; 
        }
        footer a { 
            color: #007AFF; 
            text-decoration: none; 
            transition: color 0.3s ease; 
        }
        footer a:hover { color: #005BB5; }
        @media (max-width: 768px) {
            .form-row { flex-direction: column; }
            .form-group { min-width: 100%; }
            .navbar { padding: 1rem 1.5rem; }
            .nav-menu { display: none; }
            .nav-menu.active { 
                display: flex; 
                flex-direction: column; 
                position: absolute; 
                top: 60px; 
                left: 0; 
                right: 0; 
                background: #FFFFFF; 
                padding: 1rem; 
                border-bottom: 1px solid #E5E5E5; 
            }
            .hamburger { display: block; }
            .update-header h1 { font-size: 1.8rem; }
            .update-header p { font-size: 1rem; }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="logo">Taska Elite</div>
        <ul class="nav-menu">
            <li><a href="overview.html">Overview</a></li>
            <li><a href="connections.html">Connections</a></li>
            <li><a href="explore.html">Explore</a></li>
            <li><a href="tasks.html">Tasks</a></li>
            <li><a href="profile.html" class="active">Profile</a></li>
            <li><a href="../index.html">Logout</a></li>
        </ul>
        <div class="hamburger">☰</div>
    </nav>

    <main class="dashboard-content">
        <section class="update-section">
            <div class="update-container">
                <div class="update-header">
                    <h1>Update Your Profile</h1>
                    <p>Let’s craft your standout student profile!</p>
                </div>
                <form id="update-profile-form" class="update-form">
                    <!-- Personal Information -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="name">Full Name *</label>
                            <input type="text" id="name" class="custom-input" placeholder="e.g., John Doe" required>
                        </div>
                        <div class="form-group">
                            <label for="email">Email *</label>
                            <input type="email" id="email" class="custom-input" placeholder="e.g., john@iitd.ac.in" readonly required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="whatsapp">WhatsApp Number *</label>
                            <input type="tel" id="whatsapp" class="custom-input" placeholder="e.g., +91 9876543210" required>
                        </div>
                        <div class="form-group">
                            <label for="gender">Gender *</label>
                            <select id="gender" class="custom-input" required>
                                <option value="" disabled selected>Select Gender</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <option value="not-preferred">Not Preferred</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="location">City / Location *</label>
                            <input type="text" id="location" class="custom-input" placeholder="e.g., Delhi" required>
                        </div>
                        <div class="form-group">
                            <label for="github">GitHub Username</label>
                            <div class="input-with-btn">
                                <input type="text" id="github" class="custom-input" placeholder="e.g., johndoe">
                                <button type="button" id="fetch-github" class="fetch-btn">Fetch</button>
                            </div>
                            <div id="github-summary" class="summary-box"></div>
                        </div>
                    </div>

                    <!-- College & Education -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="college">College Name *</label>
                            <input type="text" id="college" class="custom-input" placeholder="e.g., IIT Delhi" required>
                        </div>
                        <div class="form-group">
                            <label for="degree">Degree *</label>
                            <select id="degree" class="custom-input" required>
                                <option value="" disabled selected>Select Degree</option>
                                <option value="B.Tech">B.Tech</option>
                                <option value="M.Tech">M.Tech</option>
                                <option value="PhD">PhD</option>
                                <option value="Dual">Dual Degree</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="branch">Branch / Subject *</label>
                            <input type="text" id="branch" class="custom-input" placeholder="e.g., CSE" required>
                        </div>
                        <div class="form-group">
                            <label for="year">Year of Study *</label>
                            <select id="year" class="custom-input" required>
                                <option value="" disabled selected>Select Year</option>
                                <option value="1st">1st</option>
                                <option value="2nd">2nd</option>
                                <option value="3rd">3rd</option>
                                <option value="4th">4th</option>
                                <option value="5th">5th</option>
                            </select>
                        </div>
                    </div>

                    <!-- Availability -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="hours">Available Hours/Week</label>
                            <input type="number" id="hours" class="custom-input" placeholder="e.g., 10">
                        </div>
                        <div class="form-group">
                            <label for="worktime">Preferred Work Time</label>
                            <select id="worktime" class="custom-input">
                                <option value="" disabled selected>Select Time</option>
                                <option value="morning">Morning</option>
                                <option value="evening">Evening</option>
                                <option value="weekends">Weekends</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="remote">Available for Remote Work?</label>
                            <select id="remote" class="custom-input">
                                <option value="yes">Yes</option>
                                <option value="no">No</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="duration">Work Duration</label>
                            <input type="text" id="duration" class="custom-input" placeholder="e.g., 1 month">
                        </div>
                    </div>

                    <!-- Skills & Tools -->
                    <div class="form-group full-width">
                        <label for="skills">Skills (comma-separated)</label>
                        <input type="text" id="skills" class="custom-input" placeholder="e.g., Python, Figma, SEO">
                    </div>

                    <!-- Experience -->
                    <div class="form-group full-width">
                        <label for="experience">Experience (Internships/Projects)</label>
                        <textarea id="experience" class="custom-input" placeholder="e.g., Intern at XYZ, Built a web app"></textarea>
                    </div>

                    <!-- Work Samples -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="codeforces">Codeforces Username</label>
                            <div class="input-with-btn">
                                <input type="text" id="codeforces" class="custom-input" placeholder="e.g., johndoe">
                                <button type="button" id="fetch-codeforces" class="fetch-btn">Fetch</button>
                            </div>
                            <div id="codeforces-summary" class="summary-box"></div>
                        </div>
                        <div class="form-group">
                            <label for="leetcode">LeetCode Username</label>
                            <div class="input-with-btn">
                                <input type="text" id="leetcode" class="custom-input" placeholder="e.g., johndoe">
                                <button type="button" id="fetch-leetcode" class="fetch-btn">Fetch</button>
                            </div>
                            <div id="leetcode-summary" class="summary-box"></div>
                        </div>
                    </div>
                    <div class="form-group full-width">
                        <label>Portfolio / Work Samples</label>
                        <ul id="portfolio-list" class="portfolio-list"></ul>
                        <button type="button" id="add-portfolio" class="add-btn">Add Link</button>
                    </div>

                    <!-- Job Preferences -->
                    <div class="form-group full-width">
                        <label for="roles">Interested Roles (comma-separated)</label>
                        <input type="text" id="roles" class="custom-input" placeholder="e.g., Coding, Content Writing">
                    </div>

                    <!-- Soft Skills -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="communication">Communication Skill (1-5)</label>
                            <input type="number" id="communication" class="custom-input" min="1" max="5">
                        </div>
                        <div class="form-group">
                            <label for="deadlines">Can Work Under Deadlines?</label>
                            <select id="deadlines" class="custom-input">
                                <option value="yes">Yes</option>
                                <option value="no">No</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group full-width">
                        <label for="why">Why Part-Time Work?</label>
                        <textarea id="why" class="custom-input" placeholder="e.g., To gain experience"></textarea>
                    </div>

                    <!-- Form Actions -->
                    <div class="form-actions">
                        <button type="submit" class="cta-button">Save Profile</button>
                        <button type="button" class="cta-button cancel-btn" onclick="window.location.href='profile.html'">Cancel</button>
                    </div>
                </form>
            </div>
        </section>
    </main>

    <footer>
        <p>© 2025 Taska Elite. All rights reserved. | <a href="#">Privacy Policy</a></p>
    </footer>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';
        import { getDatabase, ref, get, set } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js';

        const firebaseConfig = {
            apiKey: "AIzaSyDZIDlEtaNRxODoFhRw0xF2yYFBqqBexqo",
            authDomain: "taska-45011.firebaseapp.com",
            databaseURL: "https://taska-45011-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "taska-45011",
            storageBucket: "taska-45011.firebasestorage.app",
            messagingSenderId: "205487498813",
            appId: "1:205487498813:web:0de2c9eab567482781ec54"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const userId = localStorage.getItem('userId');

        if (!userId) {
            alert("Please log in or sign up first.");
            window.location.href = '../login.html';
        } else {
            loadProfileData();
        }

        document.addEventListener('DOMContentLoaded', () => {
            const hamburger = document.querySelector('.hamburger');
            const navMenu = document.querySelector('.nav-menu');
            hamburger.addEventListener('click', () => {
                navMenu.classList.toggle('active');
            });
        });

        function loadProfileData() {
            const userRef = ref(db, `studentslist/${userId}`);
            get(userRef).then((snapshot) => {
                const data = snapshot.val() || {};
                document.getElementById('name').value = data.personal?.name || '';
                document.getElementById('email').value = data.personal?.email || '';
                document.getElementById('whatsapp').value = data.personal?.whatsapp || '';
                document.getElementById('gender').value = data.personal?.gender || '';
                document.getElementById('location').value = data.personal?.location || '';
                document.getElementById('github').value = data.profiles?.github?.username || '';
                document.getElementById('college').value = data.education?.college || '';
                document.getElementById('degree').value = data.education?.degree || '';
                document.getElementById('branch').value = data.education?.branch || '';
                document.getElementById('year').value = data.education?.year || '';
                document.getElementById('hours').value = data.availability?.hours || '';
                document.getElementById('worktime').value = data.availability?.worktime || '';
                document.getElementById('remote').value = data.availability?.remote || 'yes';
                document.getElementById('duration').value = data.availability?.duration || '';
                document.getElementById('skills').value = data.skills || '';
                document.getElementById('experience').value = data.experience || '';
                document.getElementById('codeforces').value = data.profiles?.codeforces?.username || '';
                document.getElementById('leetcode').value = data.profiles?.leetcode?.username || '';
                loadPortfolio(data.portfolio || []);
                document.getElementById('roles').value = data.preferences?.roles || '';
                document.getElementById('communication').value = data.softSkills?.communication || '';
                document.getElementById('deadlines').value = data.softSkills?.deadlines || 'yes';
                document.getElementById('why').value = data.preferences?.why || '';
                if (data.profiles) {
                    displaySummary('github', data.profiles.github?.details);
                    displaySummary('codeforces', data.profiles.codeforces?.details);
                    displaySummary('leetcode', data.profiles.leetcode?.details);
                }
            }).catch((error) => {
                console.error("Failed to load profile data: ", error);
            });
        }

        async function fetchGitHubSummary(username) {
            try {
                const userResponse = await fetch(`https://api.github.com/users/${username}`);
                if (!userResponse.ok) throw new Error('GitHub profile not found');
                const userData = await userResponse.json();

                const reposResponse = await fetch(`https://api.github.com/users/${username}/repos?per_page=100`);
                if (!reposResponse.ok) throw new Error('GitHub repos not found');
                const reposData = await reposResponse.json();

                const languages = {};
                reposData.forEach(repo => {
                    if (repo.language) languages[repo.language] = (languages[repo.language] || 0) + 1;
                });

                const projects = reposData
                    .sort((a, b) => b.stargazers_count - a.stargazers_count)
                    .slice(0, 3)
                    .map(repo => ({
                        name: repo.name,
                        description: repo.description || 'No description',
                        language: repo.language || 'N/A',
                        stars: repo.stargazers_count
                    }));

                const summary = {
                    repos: userData.public_repos,
                    languages: Object.keys(languages).sort((a, b) => languages[b] - languages[a]).slice(0, 5),
                    projects: projects
                };
                displaySummary('github', summary);
                return summary;
            } catch (error) {
                throw error;
            }
        }

        async function fetchLeetCodeSummary(username) {
            try {
                const response = await fetch(`https://leetcode-stats-api.herokuapp.com/${username}`);
                if (!response.ok) throw new Error('LeetCode profile not found');
                const data = await response.json();
                const summary = {
                    totalSolved: data.totalSolved || 0,
                    easySolved: data.easySolved || 0,
                    mediumSolved: data.mediumSolved || 0,
                    hardSolved: data.hardSolved || 0,
                    ranking: data.ranking || 'N/A'
                };
                displaySummary('leetcode', summary);
                return summary;
            } catch (error) {
                throw error;
            }
        }

        async function fetchCodeforcesSummary(username) {
            try {
                const response = await fetch(`https://codeforces.com/api/user.info?handles=${username}`);
                if (!response.ok) throw new Error('Codeforces profile not found');
                const data = await response.json();
                if (data.status !== 'OK') throw new Error('Codeforces profile not found');
                const user = data.result[0];
                const summary = {
                    rating: user.rating || 'N/A',
                    maxRating: user.maxRating || 'N/A',
                    rank: user.rank || 'N/A',
                    contribution: user.contribution || 0
                };
                displaySummary('codeforces', summary);
                return summary;
            } catch (error) {
                throw error;
            }
        }

        function displaySummary(platform, summary) {
            const summaryBox = document.getElementById(`${platform}-summary`);
            if (summary) {
                summaryBox.style.display = 'block';
                if (platform === 'github') {
                    let html = `Repos: ${summary.repos} | Languages: ${summary.languages.join(', ')}<br><strong>Top Projects:</strong><ul>`;
                    summary.projects.forEach(project => {
                        html += `<li>${project.name}: ${project.description} (Lang: ${project.language}, Stars: ${project.stars})</li>`;
                    });
                    html += '</ul>';
                    summaryBox.innerHTML = html;
                } else if (platform === 'leetcode') {
                    summaryBox.innerHTML = `<strong>Stats:</strong><br>Total Solved: ${summary.totalSolved}<br>Easy: ${summary.easySolved}<br>Medium: ${summary.mediumSolved}<br>Hard: ${summary.hardSolved}<br>Ranking: ${summary.ranking}`;
                } else if (platform === 'codeforces') {
                    summaryBox.innerHTML = `<strong>Stats:</strong><br>Rating: ${summary.rating}<br>Max Rating: ${summary.maxRating}<br>Rank: ${summary.rank}<br>Contribution: ${summary.contribution}`;
                }
            } else {
                summaryBox.style.display = 'none';
            }
        }

        function addPortfolioLink(url = '') {
            const list = document.getElementById('portfolio-list');
            const li = document.createElement('li');
            const input = document.createElement('input');
            input.type = 'url';
            input.className = 'custom-input';
            input.placeholder = 'e.g., drive.google.com/xyz';
            input.value = url;
            const removeBtn = document.createElement('button');
            removeBtn.textContent = 'Remove';
            removeBtn.className = 'add-btn';
            removeBtn.style.background = '#E63946';
            removeBtn.onclick = () => li.remove();
            li.appendChild(input);
            li.appendChild(removeBtn);
            list.appendChild(li);
        }

        function loadPortfolio(links) {
            links.forEach(url => addPortfolioLink(url));
        }

        document.getElementById('fetch-github').addEventListener('click', async () => {
            const username = document.getElementById('github').value.trim();
            if (username) {
                try {
                    await fetchGitHubSummary(username);
                } catch (error) {
                    document.getElementById('github-summary').style.display = 'none';
                    alert("Failed to fetch GitHub details: " + error.message);
                }
            }
        });

        document.getElementById('fetch-leetcode').addEventListener('click', async () => {
            const username = document.getElementById('leetcode').value.trim();
            if (username) {
                try {
                    await fetchLeetCodeSummary(username);
                } catch (error) {
                    document.getElementById('leetcode-summary').style.display = 'none';
                    alert("Failed to fetch LeetCode details: " + error.message);
                }
            }
        });

        document.getElementById('fetch-codeforces').addEventListener('click', async () => {
            const username = document.getElementById('codeforces').value.trim();
            if (username) {
                try {
                    await fetchCodeforcesSummary(username);
                } catch (error) {
                    document.getElementById('codeforces-summary').style.display = 'none';
                    alert("Failed to fetch Codeforces details: " + error.message);
                }
            }
        });

        document.getElementById('add-portfolio').addEventListener('click', () => addPortfolioLink());

        document.getElementById('update-profile-form').addEventListener('submit', async (e) => {
            e.preventDefault();

            const githubUsername = document.getElementById('github').value.trim();
            const codeforcesUsername = document.getElementById('codeforces').value.trim();
            const leetcodeUsername = document.getElementById('leetcode').value.trim();

            const profiles = {};
            if (githubUsername) {
                try {
                    profiles.github = { username: githubUsername, details: await fetchGitHubSummary(githubUsername) };
                } catch (error) {
                    console.error("GitHub fetch failed:", error);
                }
            }
            if (codeforcesUsername) {
                try {
                    profiles.codeforces = { username: codeforcesUsername, details: await fetchCodeforcesSummary(codeforcesUsername) };
                } catch (error) {
                    console.error("Codeforces fetch failed:", error);
                }
            }
            if (leetcodeUsername) {
                try {
                    profiles.leetcode = { username: leetcodeUsername, details: await fetchLeetCodeSummary(leetcodeUsername) };
                } catch (error) {
                    console.error("LeetCode fetch failed:", error);
                }
            }

            const portfolioLinks = Array.from(document.querySelectorAll('#portfolio-list input'))
                .map(input => input.value.trim())
                .filter(url => url);

            const updatedData = {
                personal: {
                    name: document.getElementById('name').value.trim(),
                    email: document.getElementById('email').value.trim(),
                    whatsapp: document.getElementById('whatsapp').value.trim(),
                    gender: document.getElementById('gender').value,
                    location: document.getElementById('location').value.trim()
                },
                education: {
                    college: document.getElementById('college').value.trim(),
                    degree: document.getElementById('degree').value,
                    branch: document.getElementById('branch').value.trim(),
                    year: document.getElementById('year').value
                },
                availability: {
                    hours: document.getElementById('hours').value.trim() || '',
                    worktime: document.getElementById('worktime').value || '',
                    remote: document.getElementById('remote').value,
                    duration: document.getElementById('duration').value.trim() || ''
                },
                skills: document.getElementById('skills').value.trim() || '',
                experience: document.getElementById('experience').value.trim() || '',
                profiles: profiles,
                portfolio: portfolioLinks.length > 0 ? portfolioLinks : [],
                preferences: {
                    roles: document.getElementById('roles').value.trim() || '',
                    why: document.getElementById('why').value.trim() || ''
                },
                softSkills: {
                    communication: document.getElementById('communication').value.trim() || '',
                    deadlines: document.getElementById('deadlines').value
                }
            };

            const userRef = ref(db, `studentslist/${userId}`);
            try {
                await set(userRef, updatedData);
                alert("Profile updated successfully!");
                window.location.href = 'profile.html';
            } catch (error) {
                alert("Failed to update profile: " + error.message);
            }
        });
    </script>
</body>
</html>