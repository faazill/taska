<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taska Elite - Update Profile</title>
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../css/global.css">
    <link rel="stylesheet" href="../css/dashboard.css">
    <link rel="stylesheet" href="../css/update-profile.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body { background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); min-height: 100vh; }
        .navbar { background: rgba(255, 255, 255, 0.95); box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); backdrop-filter: blur(5px); padding: 1rem 2rem; position: fixed; top: 0; width: 100%; z-index: 1000; }
        .dashboard-content { padding: 5rem 2rem; margin-top: 60px; }
        .update-section { max-width: 800px; margin: 0 auto; }
        .update-container { background: #fff; border-radius: 15px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); padding: 2rem; }
        .update-header h1 { font-size: 2.5rem; color: #2c3e50; margin-bottom: 0.5rem; text-align: center; }
        .update-header p { font-size: 1.2rem; color: #7f8c8d; text-align: center; margin-bottom: 2rem; }
        .update-form { display: flex; flex-direction: column; gap: 1.5rem; }
        .form-row { display: flex; gap: 1.5rem; flex-wrap: wrap; }
        .form-group { flex: 1; min-width: 300px; }
        .form-group label { display: block; font-weight: 600; color: #2c3e50; margin-bottom: 0.5rem; }
        .custom-input { width: 100%; padding: 0.8rem; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem; color: #34495e; transition: border-color 0.3s ease; }
        .custom-input:focus { border-color: #3498db; outline: none; }
        .custom-input[readonly] { background: #f5f7fa; }
        .form-group.full-width { flex: 100%; }
        textarea.custom-input { min-height: 100px; resize: vertical; }
        .form-actions { display: flex; justify-content: center; gap: 1rem; }
        .cta-button { padding: 0.8rem 2rem; background: #3498db; color: #fff; border: none; border-radius: 8px; font-size: 1rem; cursor: pointer; transition: background 0.3s ease; }
        .cta-button:hover { background: #2980b9; }
        .cancel-btn { background: #7f8c8d; }
        .cancel-btn:hover { background: #6c757d; }
        footer { background: rgba(255, 255, 255, 0.95); padding: 1rem; text-align: center; position: fixed; bottom: 0; width: 100%; box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1); }
        .dark-mode .update-container { background: #2c3e50; }
        .dark-mode .update-header h1, .dark-mode .form-group label { color: #ecf0f1; }
        .dark-mode .custom-input { background: #34495e; color: #ecf0f1; border-color: #7f8c8d; }
        .dark-mode .cta-button { background: #2980b9; }
        .dark-mode .cancel-btn { background: #6c757d; }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="logo">Taska Elite</div>
        <ul class="nav-menu">
            <li><a href="overview.html">Overview</a></li>
            <li><a href="connections.html">Connections</a></li>
            <li><a href="explore.html">Explore</a></li>
            <li><a href="tasks.html">Tasks</a></li>
            <li><a href="earnings.html">Earnings</a></li>
            <li><a href="profile.html" class="active">Profile</a></li>
            <li><a href="../index.html">Logout</a></li>
        </ul>
        <div class="hamburger">â˜°</div>
        <button class="dark-mode-toggle" onclick="toggleDarkMode()">ðŸŒ™</button>
    </nav>

    <main class="dashboard-content">
        <section class="update-section">
            <div class="update-container">
                <div class="update-header">
                    <h1>Update Your Profile</h1>
                    <p>Edit your student details below.</p>
                </div>
                <form id="update-profile-form" class="update-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="name">Name</label>
                            <input type="text" id="name" class="custom-input" placeholder="Enter Details">
                        </div>
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" id="email" class="custom-input" placeholder="Enter Details" readonly>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="location">Location</label>
                            <input type="text" id="location" class="custom-input" placeholder="Enter Details">
                        </div>
                        <div class="form-group">
                            <label for="college">Institute</label>
                            <input type="text" id="college" class="custom-input" placeholder="Enter Details">
                        </div>
                        
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="degree">Pursuing degree</label>
                            <select id="degree" class="custom-input">
                                <option value="" disabled selected>Select Degree</option>
                                <option value="Btech">Btech</option>
                                <option value="Mtech">Mtech</option>
                                <option value="Phd">Phd</option>
                                <option value="Bdes">Bdes</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="areaOfStudy">Branch/Subject</label>
                            <input type="text" id="areaOfStudy" class="custom-input" placeholder="Enter Details">
                        </div>
                        
                        <div class="form-group">
                            <label for="type">Student Type</label>
                            <select id="type" class="custom-input">
                                <option value="" disabled selected>Select your type</option>
                                <option value="fresher">Fresher</option>
                                <option value="sophomore">Sophomore</option>
                                <option value="junior">Junior</option>
                                <option value="senior">Senior</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group full-width">
                        <label for="skills">Skills (comma-separated)</label>
                        <input type="text" id="skills" class="custom-input" placeholder="Enter Details">
                    </div>

                    <div class="form-group full-width">
                        <label for="targetprofession">Profession interested in</label>
                        <input type="text" id="tarprofession" class="custom-input" placeholder="Enter Details">
                    </div>
                    <div class="form-group full-width">
                        <label for="bio">Bio</label>
                        <textarea id="bio" class="custom-input" placeholder="Enter Details"></textarea>
                    </div>
                    <div class="form-group full-width">
                        <label for="hobbies">Hobbies (comma-separated)</label>
                        <input type="text" id="hobbies" class="custom-input" placeholder="Enter Details">
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="cta-button">Save Changes</button>
                        <button type="button" class="cta-button cancel-btn" onclick="window.location.href='profile.html'">Cancel</button>
                    </div>
                </form>
            </div>
        </section>
    </main>

    <footer>
        <p>Â© 2025 Taska Elite. All rights reserved. | <a href="#" class="privacy-policy">Privacy Policy</a></p>
    </footer>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';
        import { getDatabase, ref, get, set } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js';

        const firebaseConfig = {
            apiKey: "AIzaSyDZIDlEtaNRxODoFhRw0xF2yYFBqqBexqo",
            authDomain: "taska-45011.firebaseapp.com",
            databaseURL: "https://taska-45011-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "taska-45011",
            storageBucket: "taska-45011.firebasestorage.app",
            messagingSenderId: "205487498813",
            appId: "1:205487498813:web:0de2c9eab567482781ec54"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const userId = localStorage.getItem('userId');

        if (!userId) {
            alert("Please log in or sign up first.");
            window.location.href = '../login.html';
        }

        document.getElementById('email').value = localStorage.getItem('userEmail') || '';

        function loadProfileData() {
            const userRef = ref(db, `studentslist/${userId}`);
            get(userRef).then((snapshot) => {
                const data = snapshot.val() || {};
                document.getElementById('name').value = data.name || '';
                document.getElementById('email').value = data.email || '';
                document.getElementById('location').value = data.location || '';
                document.getElementById('areaOfStudy').value = data.areaOfStudy || '';
                document.getElementById('type').value = data.type || '';
                document.getElementById('college').value = data.college || '';
                document.getElementById('degree').value = data.degree || '';
                document.getElementById('skills').value = data.skills || '';
                document.getElementById('tarprofession').value = data.tarprofession || '';
                document.getElementById('bio').value = data.bio || '';
                document.getElementById('hobbies').value = data.hobbies || '';
            }).catch((error) => {
                alert("Failed to load profile data: " + error.message);
            });
        }

        document.getElementById('update-profile-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const updatedData = {
                email: document.getElementById('email').value,
                name: document.getElementById('name').value,
                location: document.getElementById('location').value,
                areaOfStudy: document.getElementById('areaOfStudy').value,
                college: document.getElementById('college').value,
                degree: document.getElementById('degree').value,
                type: document.getElementById('type').value,
                skills: document.getElementById('skills').value,
                tarprofession: document.getElementById('tarprofession').value,
                bio: document.getElementById('bio').value,
                hobbies: document.getElementById('hobbies').value,
                isVisible: true

            };

            const userRef = ref(db, `studentslist/${userId}`);
            set(userRef, updatedData)
                .then(() => {
                    alert("Profile updated successfully!");
                    window.location.href = 'profile.html';
                })
                .catch((error) => {
                    alert("Failed to update profile: " + error.message);
                });
        });

        window.onload = loadProfileData;
    </script>
</body>
</html>